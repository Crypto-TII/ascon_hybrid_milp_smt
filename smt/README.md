# Satisfiability Modulo Theory (SMT) Model for Ascon Permutation

This repository contains the SMT model of Ascon permutation implemented as a python module in `ascon.py`. To run it,
install the [Simple Theorem Prover (STP)](https://github.com/stp/stp) and enable its python interface.

## Usage Examples

There are two main classes in the `ascon.py`: `AsconDifferential` and `AsconLinear`. As the name suggest, the former is
the SMT model of the differential trail propagation while the latter is the SMT model of the linear trail propagation.

Suppose one wants to construct a 3-round instance for the differential case, then run the python REPL in this folder and
execute the following

    >>> from ascon import AsconDifferential
    >>> A = AsconDifferential(nrounds=3)

To fix the no. of S-Boxes at round 0, 1, and 2 to be equal to 1, 3, and 11. Then 

    >>> A.set_nactive_sboxes_at_round(0, 1)
    >>> A.set_nactive_sboxes_at_round(1, 3)
    >>> A.set_nactive_sboxes_at_round(2, 11)

In order to check if a trail exists, simply run

    >>> A.has_trail()
    True
    >>> print(A.trail())
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ---------------------------------------------------------------- pS
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ...............................................................1
    ---------------------------------------------------------------- pL
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ......1.................................1......................1
    ---------------------------------------------------------------- pS
    ................................................................
    ......1.................................1......................1
    ................................................................
    ................................................................
    ......1.................................1......................1
    ---------------------------------------------------------------- pL
    ................................................................
    ...1..1........1.....................11.1....1..............1..1
    ................................................................
    ................................................................
    .............1...1.............................................1
    ---------------------------------------------------------------- pS
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ---------------------------------------------------------------- pL
    ................................................................
    ................................................................
    ................................................................
    ................................................................
    ................................................................

By default the model returns a trail core, i.e. it omits the input difference to the `pS` in round 0 and the output
difference of `pS` in the last round. For more description, see the docstring of all class methods in `ascon.py`.
